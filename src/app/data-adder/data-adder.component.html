<div *ngIf="loading;then load else page"></div>

<ng-template #load>
  <div class="text-center w-100 bg-white p-5">
    <app-spinner></app-spinner>
  </div>
</ng-template>

<ng-template #page>
  <div [formGroup]="form">
    <label for="">Question:</label>
    <textarea class="form-control" formControlName="question" rows="6" dir="rtl"></textarea>
    <div class="text-danger" *ngIf="form.controls['question'].invalid && form.controls['question'].dirty">
      <span *ngIf="form.controls['question'].errors?.['required']">This Field is Required</span>
      <span *ngIf="form.controls['question'].errors?.['minlength']">The problem needs to be at least 5 Characters</span>
    </div>
    <app-latex [content]="form.value.question"></app-latex>
    <label for="">Answer:</label>
    <textarea class="form-control" formControlName="answer" rows="6" dir="rtl"></textarea>
    <div class="text-danger" *ngIf="form.controls['answer'].invalid && form.controls['answer'].dirty">
      <span *ngIf="form.controls['answer'].errors?.['required']">This Field is Required</span>
      <span *ngIf="form.controls['answer'].errors?.['minlength']">The answer needs to be at least 1 Character</span>
    </div>
    <app-latex [content]="form.value.answer"></app-latex>
    <label for="">Reasoning:</label>
    <textarea class="form-control" formControlName="reason" rows="6" dir="rtl"></textarea>
    <div class="text-danger" *ngIf="form.controls['reason'].invalid && form.controls['reason'].dirty">
      <span *ngIf="form.controls['reason'].errors?.['required']">This Field is Required</span>
      <span *ngIf="form.controls['reason'].errors?.['minlength']">The reason needs to be at least 5 Characters</span>
    </div>
  </div>

  <app-upload></app-upload>

  <div class="alert alert-danger mt-2" *ngIf="errorMessage != null">{{ errorMessage }}</div>

  <button class="btn btn-primary my-2" (click)="addRecord()">Save</button>

  <div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div class="toast show" role="alert" aria-live="assertive" aria-atomic="true" id="liveToast" *ngIf="showToast">
      <div class="toast-header">
        <strong class="me-auto">New Record Added</strong>
        <small>3ash, ya wa7sh ðŸ’ªðŸ’ªðŸ’ª</small>
        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close" (click)="showToast = false"></button>
      </div>
      <div class="toast-body">
        Saved Record Successfully
      </div>
    </div>
  </div>
</ng-template>

